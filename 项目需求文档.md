# PredictX 产品需求文档 (PRD)

## 📋 文档信息

**文档版本**: v3.0
**最后更新**: 2025-10-29
**目标读者**: 产品经理、开发团队
**项目阶段**: 新项目启动

---

## 🎯 产品概述

### 产品定位
PredictX 是一个**去中心化的短期加密货币价格预测平台**，用户可以预测 BTC/ETH 价格在未来 1/3/5 分钟内的涨跌方向，通过正确预测获得收益。

### 核心特点
- ⚡ **超短期预测**：1分钟/3分钟/5分钟级别
- 🎯 **简单易懂**：只需预测涨/跌（UP/DOWN）
- 💰 **快速结算**：市场结束后自动结算，秒级到账
- 🔐 **去中心化**：链上结算，资金安全透明

### 目标用户
1. **普通用户**：对加密货币价格走势有判断，希望短期获利
2. **专业交易者**：使用 API 快速下单，高频交易
3. **做市商**：提供流动性，赚取手续费

---

## 🌐 技术基础设施

### 区块链网络
- **网络名称**: Socrates Testnet
- **Chain ID**: 1111111
- **RPC**: https://rpc-test.socrateschain.org
- **浏览器**: https://testnet.socrateschain.org
- **Gas 费用**: 免费

### 价格数据源
- **Oracle API**: https://api-oracle-test.socrateschain.org/api-docs
- **价格推送**: 每个整分钟稳定推送 BTC/ETH 价格
- **数据准确性**: 与主流交易所价格一致

---

## 👥 用户角色

### 1. 预测用户（Taker）
- **目标**：通过正确预测价格涨跌获利
- **行为**：查看市场 → 选择方向 → 下单 → 等待结算 → 提款
- **痛点**：需要快速下单，实时看到市场变化

### 2. 做市商（Maker）
- **目标**：提供流动性，赚取手续费
- **行为**：在订单簿中挂单，等待用户成交
- **痛点**：需要 API 快速铺单，批量管理订单

### 3. 平台管理员
- **目标**：维护平台稳定运行
- **行为**：监控市场状态，确保及时结算
- **痛点**：需要自动化监控和告警

---

## 🎨 核心功能需求

### 1. 用户登录注册 🔐

#### 用户故事
> "作为一个新用户，我想快速注册登录，而不需要了解复杂的钱包和私钥概念。"

#### 功能描述
- 用户使用邮箱或社交账号（Google/Twitter）登录
- 系统自动为用户创建托管钱包
- 无需记忆私钥，密码找回简单

#### 验收标准
- [ ] 用户可以通过邮箱 1 分钟内完成注册登录
- [ ] 登录后自动连接到正确的区块链网络
- [ ] 支持 Google、Twitter 社交登录
- [ ] 钱包断开后可以快速重连

#### 优先级：P1 🟡

---

### 2. 市场大厅 📊

#### 用户故事
> "作为用户，我想看到所有可预测的市场，并选择我感兴趣的时间范围进行预测。"

#### 功能描述

**市场展示**：
- 显示 BTC 和 ETH 的 1分钟/3分钟/5分钟市场
- 每个市场显示：
  - 当前价格
  - 开始时间和结束时间
  - 倒计时
  - 市场状态（即将开始/进行中/已结束）
  - 当前赔率（买涨/买跌的价格）

**筛选功能**：
- 按资产筛选（BTC/ETH）
- 按时间框架筛选（1m/3m/5m）
- 按状态筛选（活跃/即将开始/已结束）

**自动刷新**：
- 市场信息每 5 秒自动刷新
- 倒计时精确到秒

#### 验收标准
- [ ] 显示所有活跃市场，信息完整准确
- [ ] 市场倒计时实时更新，精确到秒
- [ ] 筛选功能正常，响应迅速
- [ ] 点击市场进入详情页

#### 优先级：P0 🔴

---

### 3. 订单簿与深度 📈

#### 用户故事
> "作为交易者，我想看到当前市场的买卖挂单情况，以便判断市场深度和选择合适的价格。"

#### 功能描述

**订单簿展示**：
- 左侧显示买单（看涨 UP）
- 右侧显示卖单（看跌 DOWN）
- 每个价格档位显示：
  - 价格（以百分比显示，如 55%）
  - 数量（USDC）
  - 订单数量

**价格排序**：
- 买单按价格从高到低排序（最高价在上）
- 卖单按价格从低到高排序（最低价在上）

**实时更新**：
- 订单簿数据实时更新（< 1 秒延迟）
- 用户自己的订单高亮显示
- 最新成交记录滚动显示

**深度图**：
- 可视化显示买卖盘深度
- 横轴为价格，纵轴为累计数量

#### 验收标准
- [ ] 订单簿数据准确无误
- [ ] 更新延迟 < 1 秒
- [ ] 价格排序正确
- [ ] 用户订单高亮显示
- [ ] 深度图清晰易懂

#### 优先级：P1 🟡

---

### 4. 快速下单 💰

#### 用户故事
> "作为用户，我想快速下单预测价格涨跌，操作要简单直观。"

#### 功能描述

**两种下单模式**：

##### 模式 1：快速预测（推荐新手）
- 用户选择：
  - 预测方向：看涨 UP / 看跌 DOWN
  - 投入金额：50 USDC / 100 USDC / 自定义
- 系统自动：
  - 匹配当前最优价格
  - 立即成交
  - 显示预期收益

**示例**：
```
选择：看涨 UP
金额：100 USDC
当前价格：55%（意味着投入 100 USDC，最多赚 82 USDC）
点击"确认预测"
```

##### 模式 2：限价挂单（专业用户）
- 用户选择：
  - 预测方向：看涨 UP / 看跌 DOWN
  - 自定义价格：40% - 60%（合理范围）
  - 投入金额：自定义
- 系统处理：
  - 将订单放入订单簿
  - 等待其他用户匹配
  - 可能部分成交或完全成交

**示例**：
```
选择：看涨 UP
价格：52%（更优惠的价格）
金额：100 USDC
点击"挂单等待"
```

#### 下单流程
1. 用户输入预测方向和金额
2. 系统检查余额是否充足
3. 用户确认订单详情
4. 系统提交订单
5. 显示订单状态（待撮合/已成交）

#### 验收标准
- [ ] 快速预测模式：2 秒内完成成交
- [ ] 限价挂单模式：成功提交到订单簿
- [ ] 余额不足时友好提示
- [ ] 显示预期收益计算
- [ ] 订单状态实时更新

#### 优先级：P0 🔴

---

### 5. 我的持仓 📦

#### 用户故事
> "作为用户，我想随时查看我的持仓情况，包括盈亏和可赎回金额。"

#### 功能描述

**持仓列表**：
- 按市场分组显示
- 每个持仓显示：
  - 市场名称（如"BTC 1分钟 #123"）
  - 预测方向（看涨/看跌）
  - 投入金额
  - 买入价格
  - 当前状态（进行中/已结束）
  - 盈亏情况（+/- USDC）

**筛选功能**：
- 活跃持仓（市场进行中）
- 已结束持仓（可赎回）

**盈亏计算**：
- 进行中：显示预期收益
- 已结束：
  - 预测正确：显示实际盈利（绿色）
  - 预测错误：显示亏损金额（红色）

**统计信息**：
- 总投入
- 总收益
- 胜率
- 可提款金额

#### 验收标准
- [ ] 持仓数据准确无误
- [ ] 盈亏计算正确
- [ ] 实时更新持仓状态
- [ ] 支持多市场持仓展示
- [ ] 统计信息准确

#### 优先级：P0 🔴

---

### 6. 自动结算与提款 💸

#### 用户故事
> "作为用户，市场结束后，我希望系统自动结算，并能快速提取我的收益。"

#### 功能描述

**自动结算**：
- 市场到期后，系统自动：
  1. 从 Oracle 获取开始和结束时的价格
  2. 对比价格涨跌
  3. 确定预测正确的用户（赢家）
  4. 将资金分配到赢家账户

**结算时间**：
- 市场结束后 30 秒内完成结算
- 用户收到结算通知

**一键提款**：
- 用户点击"提款"按钮
- 系统自动：
  - 检测所有可赎回的持仓
  - 计算总可提款金额
  - 批量提取所有收益
- 资金到账用户钱包

**提款历史**：
- 显示提款记录
- 每条记录包含：
  - 提款时间
  - 提款金额
  - 交易哈希（可查询）

#### 验收标准
- [ ] 市场结束后 30 秒内完成结算
- [ ] 用户收到结算通知
- [ ] 一键提款成功率 > 99%
- [ ] 提款后余额立即更新
- [ ] 提款历史准确记录

#### 优先级：P0 🔴

---

### 7. 资金管理 💵

#### 用户故事
> "作为用户，我需要充值和提现 USDC，管理我的账户余额。"

#### 功能描述

**充值**：
- 显示用户钱包地址（可复制）
- 支持从其他钱包转入 USDC
- 充值到账时间：1-2 分钟
- 充值记录查询

**提现**：
- 输入提现金额和目标地址
- 显示手续费（如果有）
- 确认后发起提现
- 提现到账时间：3-5 分钟

**余额展示**：
- 可用余额
- 持仓占用金额
- 待结算金额
- 总资产

**交易记录**：
- 充值记录
- 提现记录
- 下单记录
- 提款记录

#### 验收标准
- [ ] 充值 1-2 分钟到账
- [ ] 提现 3-5 分钟到账
- [ ] 余额计算准确
- [ ] 交易记录完整

#### 优先级：P1 🟡

---

### 8. 做市商 API 🤖

#### 用户故事
> "作为做市商，我需要通过 API 快速在多个市场铺单，并管理我的订单。"

#### 功能描述

**API 功能**：
- 查询市场列表
- 获取订单簿
- 提交订单（限价单）
- 取消订单
- 批量下单
- 查询订单状态
- 查询持仓

**API 特性**：
- RESTful API 设计
- 响应时间 < 100ms
- 支持批量操作
- 完整的错误码和错误信息
- API 文档（Swagger）

**认证方式**：
- API Key + Secret
- 签名验证
- IP 白名单（可选）

**速率限制**：
- 普通用户：100 请求/分钟
- 做市商：1000 请求/分钟
- 超限后返回 429 错误

#### 验收标准
- [ ] API 响应时间 < 100ms
- [ ] 支持批量下单（最多 50 个/次）
- [ ] 错误信息清晰明确
- [ ] API 文档完整准确
- [ ] 做市商可稳定铺单

#### 优先级：P1 🟡

---

## ⚡ 性能要求

### 响应时间

| 操作 | 目标时间 |
|------|---------|
| 页面加载 | < 2 秒 |
| 订单提交 | < 200ms |
| 订单撮合 | < 1 秒 |
| 订单簿更新 | < 1 秒 |
| 市场结算 | < 30 秒 |
| 资金到账 | 1-5 分钟 |

### 吞吐量

| 指标 | 目标值 |
|------|--------|
| 并发用户 | 10,000+ |
| 订单处理 | 1,000 TPS |
| API 请求 | 100,000 QPM |

### 可用性

| 指标 | 目标值 |
|------|--------|
| 系统可用性 | 99.9% |
| 结算成功率 | 99.9% |
| 提款成功率 | 99.5% |

---

## 🎯 用户体验要求

### 易用性
- [ ] 新用户 5 分钟内完成首次预测
- [ ] 操作流程不超过 3 步
- [ ] 所有功能都有提示和说明
- [ ] 错误提示清晰，提供解决方案

### 响应性
- [ ] 所有操作有即时反馈（加载动画）
- [ ] 关键操作有确认弹窗
- [ ] 成功/失败操作有明确提示

### 多语言支持
- [ ] 中文（简体）
- [ ] 英文
- [ ] 日文（可选）

### 多设备支持
- [ ] PC 端（Chrome/Firefox/Safari）
- [ ] 移动端（响应式设计）
- [ ] 平板适配

---

## 🔐 安全要求

### 用户资金安全
- [ ] 智能合约经过专业审计
- [ ] 资金托管在链上，不可篡改
- [ ] 用户资金与平台资金隔离
- [ ] 支持时间锁和多签（紧急情况）

### 账户安全
- [ ] 邮箱验证
- [ ] 两步验证（2FA）可选
- [ ] 异常登录检测
- [ ] 大额提现二次确认

### 数据安全
- [ ] HTTPS 加密传输
- [ ] 敏感数据加密存储
- [ ] 定期数据备份
- [ ] 日志审计

### 反作弊
- [ ] IP 限制和黑名单
- [ ] 异常交易检测
- [ ] 刷单行为识别
- [ ] API 速率限制

---

## 📊 功能优先级总结

### P0 - MVP 核心功能（必须有）🔴

1. **市场大厅**：展示可预测的市场
2. **快速下单**：用户快速提交预测
3. **我的持仓**：查看持仓和盈亏
4. **自动结算**：市场自动结算并分配资金
5. **一键提款**：快速提取收益

**目标**：用户可以完整体验"预测 → 等待 → 收益"的流程

---

### P1 - 重要功能（尽快实现）🟡

6. **用户登录**：托管钱包（邮箱登录）
7. **订单簿**：查看市场深度
8. **资金管理**：充值和提现
9. **做市商 API**：支持专业用户
10. **实时推送**：订单簿和成交记录实时更新

**目标**：提升用户体验和吸引专业用户

---

### P2 - 增强功能（后续迭代）🟢

11. **K线图表**：价格走势可视化
12. **交易历史**：完整的交易记录
13. **排行榜**：展示盈利用户和交易量
14. **推荐奖励**：邀请好友获得返佣
15. **移动 App**：iOS/Android 原生应用

**目标**：丰富功能和提升用户粘性

---

## 📅 开发里程碑

### Milestone 1: MVP 上线（4-6 周）

**目标**：实现核心预测流程

- [x] 市场大厅展示
- [x] 快速下单功能
- [x] 持仓查询
- [x] 自动结算服务
- [x] 一键提款

**验收**：
- 用户可以完整完成一次预测流程
- 结算正确，资金准确到账

---

### Milestone 2: 用户体验优化（2-3 周）

**目标**：提升用户体验和留存

- [x] 托管钱包登录（Privy）
- [x] 实时订单簿推送
- [x] 资金充值提现
- [x] 前端界面美化

**验收**：
- 新用户注册流程顺畅
- 界面美观易用
- 实时数据更新流畅

---

### Milestone 3: 专业用户支持（2-3 周）

**目标**：吸引做市商和专业交易者

- [x] 完整的做市商 API
- [x] 批量下单和订单管理
- [x] 深度图和K线图
- [x] 交易历史记录

**验收**：
- 做市商可通过 API 稳定铺单
- 专业用户可进行高频交易

---

### Milestone 4: 功能扩展（持续迭代）

**目标**：增加市场类型和功能

- [ ] ETH 市场支持
- [ ] 更多时间框架（10分钟/30分钟）
- [ ] 移动端 App
- [ ] 社交功能（聊天室）

---

## 📈 成功指标（KPI）

### 用户指标
- **注册用户数**：目标 10,000+
- **日活用户（DAU）**：目标 1,000+
- **用户留存率**：
  - 次日留存 > 40%
  - 7日留存 > 20%
  - 30日留存 > 10%

### 交易指标
- **日交易量**：目标 $100,000+
- **日订单数**：目标 10,000+
- **订单成交率**：> 80%
- **平均订单金额**：$50-$200

### 收入指标
- **协议收入**：手续费收入
- **做市商数量**：目标 50+
- **总锁仓量（TVL）**：目标 $1,000,000+

### 体验指标
- **平均响应时间**：< 1 秒
- **结算成功率**：> 99.9%
- **用户满意度**：> 4.5/5

---

## 🚫 功能边界（不做什么）

### 当前版本不做
1. ❌ 长期预测市场（> 1 小时）
2. ❌ 杠杆交易
3. ❌ 借贷功能
4. ❌ NFT 和游戏化
5. ❌ 社交代币
6. ❌ 跨链桥接

### 原因
- 专注于短期价格预测核心功能
- 避免功能过度复杂
- 降低开发和维护成本
- 减少监管风险

---

## 🎨 设计原则

### 简洁优先
- 首页只展示核心功能
- 去除不必要的装饰元素
- 操作流程最小化

### 移动优先
- 设计首先考虑移动端体验
- 关键操作适配大拇指操作区
- 响应式布局

### 即时反馈
- 所有操作都有即时视觉反馈
- 加载状态清晰显示
- 错误提示友好明确

### 数据可视化
- 用图表展示复杂数据
- 颜色编码（绿涨红跌）
- 动画过渡自然流畅

---

## 📞 支持与文档

### 用户支持
- **帮助中心**：常见问题 FAQ
- **新手教程**：图文或视频教程
- **在线客服**：工作时间内响应
- **社区**：Telegram/Discord 群组

### 开发文档
- **API 文档**：完整的接口说明
- **智能合约文档**：合约接口和事件
- **SDK**：JavaScript/Python SDK（可选）

---

## 🔄 持续改进

### 用户反馈收集
- 应用内反馈按钮
- 用户调研问卷
- 社区反馈收集
- 数据分析和行为追踪

### 迭代计划
- 每 2 周发布一次更新
- 根据用户反馈调整优先级
- 持续优化性能和体验

---

## 📝 附录

### 名词解释

**预测市场（Prediction Market）**：
用户对未来事件的结果进行预测和交易的平台。

**CTF (Conditional Token Framework）**：
条件代币框架，用于管理预测市场的持仓和结算。

**Maker / Taker**：
- Maker（做市商）：在订单簿中挂单，提供流动性
- Taker（接受者）：立即成交订单簿中的挂单

**BPS (Basis Points)**：
基点，1 BPS = 0.01%。价格使用 0-10000 BPS 表示 0%-100%。

**Oracle（预言机）**：
为智能合约提供外部数据（如价格）的服务。

**USDC**：
美元稳定币，1 USDC ≈ 1 USD。

---

**文档维护**: 本文档根据产品迭代持续更新
**反馈渠道**: 产品需求变更请联系产品经理
**版本历史**: 查看文档末尾的变更日志
